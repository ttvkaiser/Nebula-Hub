local player = game.Players.LocalPlayer
local muscleEvent = player:WaitForChild("muscleEvent")
local replicatedStorage = game:GetService("ReplicatedStorage")

local function unequipPets()
    for _, folder in pairs(player.petsFolder:GetChildren()) do
        if folder:IsA("Folder") then
            for _, pet in pairs(folder:GetChildren()) do
                replicatedStorage.rEvents.equipPetEvent:FireServer("unequipPet", pet)
            end
        end
    end
    task.wait(0.1)
end

local function equipPetsByName(name)
    unequipPets()
    task.wait(0.01)
    for _, pet in pairs(player.petsFolder.Unique:GetChildren()) do
        if pet.Name == name then
            replicatedStorage.rEvents.equipPetEvent:FireServer("equipPet", pet)
        end
    end
end

local function fastTrainAndRebirthLoop()
    while true do
        equipPetsByName("Swift Samurai")

        local rebirths = player.leaderstats.Rebirths.Value
        local strengthTarget = 10000 + (rebirths * 5000)
        if player.ultimatesFolder:FindFirstChild("Golden Rebirth") then
            local golden = player.ultimatesFolder["Golden Rebirth"].Value
            strengthTarget = math.floor(strengthTarget * (1 - (golden * 0.1)))
        end

        while player.leaderstats.Strength.Value < strengthTarget do
            for _ = 1, 10 do
                muscleEvent:FireServer("rep")
            end
            task.wait(0.01)
        end

        equipPetsByName("Tribal Overlord")
        task.wait(0.2)

        local before = player.leaderstats.Rebirths.Value
        repeat
            replicatedStorage.rEvents.rebirthRemote:InvokeServer("rebirthRequest")
            task.wait(0.1)
        until player.leaderstats.Rebirths.Value > before

        task.wait(0.5)
    end
end

task.spawn(fastTrainAndRebirthLoop)
